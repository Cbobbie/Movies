# How many records are in the u.data and u.item tables? 

SELECT COUNT(*) 
FROM udata;
SELECT COUNT(*) 
FROM uitem;

# Find the names of all movies released in 1990

SELECT movie_title 
FROM udata 
WHERE release_date LIKE '%1990';

#alternatively:
CREATE TABLE uitemdate AS 
SELECT movieid, movie_title, substr(relase_date, 8, 4) 
FROM uitem;
SELECT movie_title 
FROM uitemdate 
WHERE year = 1990;

# List the movieid of the 10 films that recieved the most ratings.

CREATE TABLE moviecnt AS
SELECT movieid, COUNT(*) AS cnt 
FROM udata 
GROUP BY movieid 
ORDER BY cnt DESC 
LIMIT 10;

#List the titles of the movies with the 10 most ratings.

SELECT a.movieid, a.cnt, b.movie_title
FROM moviecnt AS a
JOIN uitem AS b
ON a.movieid=b.movieid
ORDER BY a.cnt DESC;

#Find the highest average rated sci_fi movie.

SELECT AVG(a.rating) as rating, b.movie_title
FROM udata AS a
JOIN uitem AS b
ON a.movieid=b.movieid 
WHERE b.scifi=1
GROUP BY movie_title
ORDER BY rating DESC
LIMIT 1;

#Are there any movies with no ratings?

SELECT movie_title 
FROM udata 
LEFT OUTER JOIN u.item ON (udata.movieid=uitem.movieid) 
WHERE uitem.movieid IS NULL.



